[2025-03-27T08:57:37.036+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-27T08:57:37.065+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: construction_web_scraping_v01.scrape_and_store scheduled__2025-03-02T00:00:00+00:00 [queued]>
[2025-03-27T08:57:37.077+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: construction_web_scraping_v01.scrape_and_store scheduled__2025-03-02T00:00:00+00:00 [queued]>
[2025-03-27T08:57:37.078+0000] {taskinstance.py:2867} INFO - Starting attempt 5 of 6
[2025-03-27T08:57:37.101+0000] {taskinstance.py:2890} INFO - Executing <Task(PythonOperator): scrape_and_store> on 2025-03-02 00:00:00+00:00
[2025-03-27T08:57:37.109+0000] {standard_task_runner.py:72} INFO - Started process 7451 to run task
[2025-03-27T08:57:37.115+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'construction_web_scraping_v01', 'scrape_and_store', 'scheduled__2025-03-02T00:00:00+00:00', '--job-id', '72', '--raw', '--subdir', 'DAGS_FOLDER/construction_web_scraping.py', '--cfg-path', '/tmp/tmpcmg05ht7']
[2025-03-27T08:57:37.119+0000] {standard_task_runner.py:105} INFO - Job 72: Subtask scrape_and_store
[2025-03-27T08:57:37.664+0000] {task_command.py:467} INFO - Running <TaskInstance: construction_web_scraping_v01.scrape_and_store scheduled__2025-03-02T00:00:00+00:00 [running]> on host c79bd584e644
[2025-03-27T08:57:37.790+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='waiyong' AIRFLOW_CTX_DAG_ID='construction_web_scraping_v01' AIRFLOW_CTX_TASK_ID='scrape_and_store' AIRFLOW_CTX_EXECUTION_DATE='2025-03-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='5' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-03-02T00:00:00+00:00'
[2025-03-27T08:57:37.793+0000] {taskinstance.py:732} INFO - ::endgroup::
[2025-03-27T08:57:37.814+0000] {logging_mixin.py:190} INFO - Scraping page 1...
[2025-03-27T08:57:56.133+0000] {logging_mixin.py:190} INFO - Scraping page 2...
[2025-03-27T08:58:19.472+0000] {logging_mixin.py:190} INFO - Scraping page 3...
[2025-03-27T08:58:41.682+0000] {logging_mixin.py:190} INFO - Scraping page 4...
[2025-03-27T08:58:59.633+0000] {logging_mixin.py:190} INFO - Scraping page 5...
[2025-03-27T08:59:18.951+0000] {logging_mixin.py:190} INFO - Scraping page 6...
[2025-03-27T08:59:37.322+0000] {logging_mixin.py:190} INFO - Error scraping https://teduh.kpkt.gov.my/project-swasta/30692-1: HTTPSConnectionPool(host='teduh.kpkt.gov.my', port=443): Max retries exceeded with url: /project-swasta/30692-1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fca6861dd80>, 'Connection to teduh.kpkt.gov.my timed out. (connect timeout=10)'))
[2025-03-27T08:59:47.645+0000] {logging_mixin.py:190} INFO - Scraping page 7...
[2025-03-27T09:00:06.041+0000] {logging_mixin.py:190} INFO - Scraping page 8...
[2025-03-27T09:00:31.651+0000] {logging_mixin.py:190} INFO - Scraping page 9...
[2025-03-27T09:00:59.849+0000] {logging_mixin.py:190} INFO - Scraping page 10...
[2025-03-27T09:01:17.766+0000] {logging_mixin.py:190} INFO - Scraping page 11...
[2025-03-27T09:01:36.334+0000] {logging_mixin.py:190} INFO - Scraping page 12...
[2025-03-27T09:02:02.884+0000] {logging_mixin.py:190} INFO - Scraping page 13...
[2025-03-27T09:02:35.508+0000] {logging_mixin.py:190} INFO - Scraping page 14...
[2025-03-27T09:03:02.521+0000] {logging_mixin.py:190} INFO - Scraping page 15...
[2025-03-27T09:03:20.135+0000] {logging_mixin.py:190} INFO - Scraping page 16...
[2025-03-27T09:03:38.167+0000] {logging_mixin.py:190} INFO - Scraping page 17...
[2025-03-27T09:03:55.890+0000] {logging_mixin.py:190} INFO - Scraping page 18...
[2025-03-27T09:04:15.152+0000] {logging_mixin.py:190} INFO - Scraping page 19...
[2025-03-27T09:04:31.717+0000] {logging_mixin.py:190} INFO - Scraping page 20...
[2025-03-27T09:04:48.513+0000] {logging_mixin.py:190} INFO - Scraping page 21...
[2025-03-27T09:05:06.073+0000] {logging_mixin.py:190} INFO - Scraping page 22...
[2025-03-27T09:05:27.396+0000] {logging_mixin.py:190} INFO - Scraping page 23...
[2025-03-27T09:05:45.351+0000] {logging_mixin.py:190} INFO - Scraping page 24...
[2025-03-27T09:06:02.161+0000] {logging_mixin.py:190} INFO - Scraping page 25...
[2025-03-27T09:06:20.214+0000] {logging_mixin.py:190} INFO - Scraping page 26...
[2025-03-27T09:06:38.288+0000] {logging_mixin.py:190} INFO - Scraping page 27...
[2025-03-27T09:06:55.785+0000] {logging_mixin.py:190} INFO - Scraping page 28...
[2025-03-27T09:07:13.582+0000] {logging_mixin.py:190} INFO - Scraping page 29...
[2025-03-27T09:07:31.133+0000] {logging_mixin.py:190} INFO - Scraping page 30...
[2025-03-27T09:07:48.898+0000] {logging_mixin.py:190} INFO - Scraping page 31...
[2025-03-27T09:08:06.088+0000] {logging_mixin.py:190} INFO - Scraping page 32...
[2025-03-27T09:08:23.824+0000] {logging_mixin.py:190} INFO - Scraping page 33...
[2025-03-27T09:08:42.852+0000] {logging_mixin.py:190} INFO - Scraping page 34...
[2025-03-27T09:09:02.059+0000] {logging_mixin.py:190} INFO - Scraping page 35...
[2025-03-27T09:09:19.173+0000] {logging_mixin.py:190} INFO - Scraping page 36...
[2025-03-27T09:09:41.947+0000] {logging_mixin.py:190} INFO - Scraping page 37...
[2025-03-27T09:10:04.363+0000] {logging_mixin.py:190} INFO - Scraping page 38...
[2025-03-27T09:10:23.951+0000] {logging_mixin.py:190} INFO - Scraping page 39...
[2025-03-27T09:10:37.395+0000] {logging_mixin.py:190} INFO - Error scraping https://teduh.kpkt.gov.my/project-swasta/20211-2: HTTPSConnectionPool(host='teduh.kpkt.gov.my', port=443): Max retries exceeded with url: /project-swasta/20211-2 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fca6830ab30>, 'Connection to teduh.kpkt.gov.my timed out. (connect timeout=10)'))
[2025-03-27T09:10:58.344+0000] {logging_mixin.py:190} INFO - Scraping page 40...
[2025-03-27T09:11:32.654+0000] {logging_mixin.py:190} INFO - Error scraping https://teduh.kpkt.gov.my/project-swasta/20193-1: HTTPSConnectionPool(host='teduh.kpkt.gov.my', port=443): Max retries exceeded with url: /project-swasta/20193-1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fca68f91de0>, 'Connection to teduh.kpkt.gov.my timed out. (connect timeout=10)'))
[2025-03-27T09:11:52.646+0000] {logging_mixin.py:190} INFO - Scraping page 41...
[2025-03-27T09:12:21.839+0000] {logging_mixin.py:190} INFO - Error scraping https://teduh.kpkt.gov.my/project-swasta/20173-3: HTTPSConnectionPool(host='teduh.kpkt.gov.my', port=443): Max retries exceeded with url: /project-swasta/20173-3 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fca680af5e0>, 'Connection to teduh.kpkt.gov.my timed out. (connect timeout=10)'))
[2025-03-27T09:12:36.946+0000] {logging_mixin.py:190} INFO - Scraping page 42...
[2025-03-27T09:12:55.445+0000] {logging_mixin.py:190} INFO - Scraping page 43...
[2025-03-27T09:13:20.913+0000] {logging_mixin.py:190} INFO - Scraping page 44...
[2025-03-27T09:14:02.894+0000] {logging_mixin.py:190} INFO - Error scraping https://teduh.kpkt.gov.my/project-swasta/20131-1: HTTPSConnectionPool(host='teduh.kpkt.gov.my', port=443): Max retries exceeded with url: /project-swasta/20131-1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fca68754c70>, 'Connection to teduh.kpkt.gov.my timed out. (connect timeout=10)'))
[2025-03-27T09:14:20.758+0000] {logging_mixin.py:190} INFO - Scraping page 45...
[2025-03-27T09:14:47.879+0000] {logging_mixin.py:190} INFO - Scraping page 46...
[2025-03-27T09:15:07.553+0000] {logging_mixin.py:190} INFO - Scraping page 47...
[2025-03-27T09:15:51.610+0000] {logging_mixin.py:190} INFO - Scraping page 48...
[2025-03-27T09:16:13.527+0000] {logging_mixin.py:190} INFO - Scraping page 49...
[2025-03-27T09:16:53.458+0000] {logging_mixin.py:190} INFO - Error scraping https://teduh.kpkt.gov.my/project-swasta/20047-1: HTTPSConnectionPool(host='teduh.kpkt.gov.my', port=443): Read timed out. (read timeout=10)
[2025-03-27T09:16:54.461+0000] {logging_mixin.py:190} INFO - Scraping page 50...
[2025-03-27T09:17:13.903+0000] {logging_mixin.py:190} INFO - Scraping page 51...
[2025-03-27T09:17:34.105+0000] {logging_mixin.py:190} INFO - Scraping page 52...
[2025-03-27T09:17:51.591+0000] {logging_mixin.py:190} INFO - Scraping page 53...
[2025-03-27T09:18:07.508+0000] {logging_mixin.py:190} INFO - Scraping page 54...
[2025-03-27T09:18:23.772+0000] {logging_mixin.py:190} INFO - Scraping page 55...
[2025-03-27T09:18:38.980+0000] {logging_mixin.py:190} INFO - Scraping page 56...
[2025-03-27T09:18:54.163+0000] {logging_mixin.py:190} INFO - Scraping page 57...
[2025-03-27T09:19:10.530+0000] {logging_mixin.py:190} INFO - Scraping page 58...
[2025-03-27T09:19:25.715+0000] {logging_mixin.py:190} INFO - Scraping page 59...
[2025-03-27T09:19:41.126+0000] {logging_mixin.py:190} INFO - Scraping page 60...
[2025-03-27T09:19:56.186+0000] {logging_mixin.py:190} INFO - Scraping page 61...
[2025-03-27T09:20:13.057+0000] {logging_mixin.py:190} INFO - Scraping page 62...
[2025-03-27T09:20:28.739+0000] {logging_mixin.py:190} INFO - Scraping page 63...
[2025-03-27T09:20:46.509+0000] {logging_mixin.py:190} INFO - Scraping page 64...
[2025-03-27T09:21:03.621+0000] {logging_mixin.py:190} INFO - Scraping page 65...
[2025-03-27T09:21:25.095+0000] {logging_mixin.py:190} INFO - Scraping page 66...
[2025-03-27T09:21:45.915+0000] {logging_mixin.py:190} INFO - Scraping page 67...
[2025-03-27T09:22:02.899+0000] {logging_mixin.py:190} INFO - Scraping page 68...
[2025-03-27T09:22:27.076+0000] {logging_mixin.py:190} INFO - Scraping page 69...
[2025-03-27T09:22:45.777+0000] {logging_mixin.py:190} INFO - Scraping page 70...
[2025-03-27T09:23:11.849+0000] {logging_mixin.py:190} INFO - Error scraping https://teduh.kpkt.gov.my/project-swasta/19739-1: HTTPSConnectionPool(host='teduh.kpkt.gov.my', port=443): Max retries exceeded with url: /project-swasta/19739-1 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x7fca68d63940>, 'Connection to teduh.kpkt.gov.my timed out. (connect timeout=10)'))
[2025-03-27T09:23:12.852+0000] {logging_mixin.py:190} INFO - Scraping page 71...
[2025-03-27T09:23:43.869+0000] {logging_mixin.py:190} INFO - Scraping page 72...
[2025-03-27T09:24:04.358+0000] {logging_mixin.py:190} INFO - Scraping page 73...
[2025-03-27T09:24:21.492+0000] {logging_mixin.py:190} INFO - Scraping page 74...
[2025-03-27T09:24:38.017+0000] {logging_mixin.py:190} INFO - Scraping page 75...
[2025-03-27T09:24:58.417+0000] {logging_mixin.py:190} INFO - Scraping page 76...
[2025-03-27T09:25:16.968+0000] {logging_mixin.py:190} INFO - Scraping page 77...
[2025-03-27T09:25:41.135+0000] {logging_mixin.py:190} INFO - Scraping page 78...
[2025-03-27T09:26:02.999+0000] {logging_mixin.py:190} INFO - Scraping page 79...
[2025-03-27T09:26:17.891+0000] {logging_mixin.py:190} INFO - Scraping page 80...
[2025-03-27T09:26:47.009+0000] {logging_mixin.py:190} INFO - Scraping page 81...
[2025-03-27T09:27:23.566+0000] {logging_mixin.py:190} INFO - Scraping page 82...
[2025-03-27T09:27:37.682+0000] {timeout.py:68} ERROR - Process timed out, PID: 7451
[2025-03-27T09:27:37.721+0000] {taskinstance.py:3313} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 763, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
  File "/opt/airflow/dags/construction_web_scraping.py", line 183, in run_scraper
    daerah, negeri, harga_min, harga_maks = scrape_additional_data(link)
  File "/opt/airflow/dags/construction_web_scraping.py", line 45, in scrape_additional_data
    response = requests.get(link, timeout=10)
  File "/home/airflow/.local/lib/python3.10/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/requests/adapters.py", line 667, in send
    resp = conn.urlopen(
  File "/home/airflow/.local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    response = self._make_request(
  File "/home/airflow/.local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
  File "/home/airflow/.local/lib/python3.10/site-packages/urllib3/connectionpool.py", line 1093, in _validate_conn
    conn.connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/urllib3/connection.py", line 704, in connect
    self.sock = sock = self._new_conn()
  File "/home/airflow/.local/lib/python3.10/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
  File "/home/airflow/.local/lib/python3.10/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/timeout.py", line 69, in handle_timeout
    raise AirflowTaskTimeout(self.error_message)
airflow.exceptions.AirflowTaskTimeout: Timeout, PID: 7451
[2025-03-27T09:27:37.749+0000] {taskinstance.py:1226} INFO - Marking task as UP_FOR_RETRY. dag_id=construction_web_scraping_v01, task_id=scrape_and_store, run_id=scheduled__2025-03-02T00:00:00+00:00, execution_date=20250302T000000, start_date=20250327T085737, end_date=20250327T092737
[2025-03-27T09:27:37.795+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-03-27T09:27:37.824+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 2
[2025-03-27T09:27:37.853+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-03-27T09:27:37.857+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
